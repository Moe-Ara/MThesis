{
  "message": "{\n  \"rule_xml\": \"<group name=\\\"custom_rules,sysmon,\\\">\\n  <!-- 100505: PowerShell spawns script/executable child -->\\n  <rule id=\\\"100505\\\" level=\\\"10\\\">\\n    <if_sid>61602</if_sid>\\n    <!-- check for a child process with non-explorer .exe or .psx -->\\n    <field name=\\\"win.eventdata.image\\\">!(powershell.exe|.\\*.exe|\\*.psx)</field>\\n    <!-- ignore explorer.exe, powershell.exe, and wscript.exe -->\\n    <match>!explorer.exe|powershell.exe|wscript.exe</match>\\n    <description>Lab: PowerShell spawns script/executable child</description>\\n    <group>sysmon,windows,lab_powershell_child,</group>\\n  </rule>\\n</group>\",\n  \"explanation\": \"This rule detects when PowerShell (powershell.exe) spawns a new process with an executable file (.exe or .psx) that is not explorer.exe, powershell.exe, or wscript.exe.\",\n  \"tuning_suggestions\": [\n    \"Consider adding exceptions for legitimate processes that use PowerShell, such as Microsoft Teams or VSCode.\",\n    \"If false positives are high, adjust the level of the rule to reduce its priority.\"\n  ],\n  \"test_plan\": [\n    \"Generate test events with PowerShell spawning non-legitimate child processes, such as .ps1 scripts or executables not typically associated with Windows.\",\n    \"Verify that the rule triggers an alert and is logged in the Wazuh manager.\"\n  ]\n}"
}